import A from'@anthropic-ai/sdk';import{exec}from'child_process';import{promisify}from'util';import*as r from'readline'
const e=promisify(exec),a=new A({apiKey:process.env.API_KEY}),c=[],l=r.createInterface({input:process.stdin,output:process.stdout})
async function f(u){u&&c.push({role:'user',content:u});let s=await a.messages.create({model:'claude-sonnet-4-20250514',max_tokens:4e3,messages:c,system:'You:coder;Bash:your katana',tools:[{name:'bash',description:'sh',input_schema:{type:'object',properties:{cmd:{type:'string'}}}}]});c.push({role:'assistant',content:s.content});for(let t of s.content)if(t.type=='tool_use'){console.log('ðŸ”§',t.input.cmd);try{var o=(await e(t.input.cmd)).stdout}catch(x){o='Error: '+x.message}console.log(o);c.push({role:'user',content:[{type:'tool_result',tool_use_id:t.id,content:o}]});return f()}return s.content.find(t=>t.type=='text')?.text}
for(;;){let i=await new Promise(v=>l.question('> ',v));if(i=='exit')break;i&&console.log(await f(i))}
